(() => {
  "use strict";
  $(document).ready(function () {
    $(".header__burger").click(function (e) {
      $(".header__burger,.header__menu").toggleClass("active"),
        $("body").toggleClass("lock"),
        $(".header__menu").hasClass("active")
          ? $(".left-menu__button").css({ display: "none" })
          : $(".left-menu__button").css({ display: "block" });
    });
  }),
    $(document).ready(function () {
      let e = $(".menu__item"),
        t = ($(".menu__sub"), $(".menu__link")),
        o = $(".bg-grey"),
        n =
          ($(".header").outerHeight(),
          $("section:first").outerHeight() +
            parseFloat($(".margin-bottom-row").css("margin-bottom")));
      function i() {
        $(window).width() >= 992
          ? (o.height(n),
            e
              .on("mouseenter", function () {
                $(this).find(".sub-menu").stop().fadeIn(),
                  $(this).find(t).addClass("active");
              })
              .on("mouseleave", function () {
                $(this).find(t).removeClass("active"),
                  $(this).find(".sub-menu").stop().hide();
              }),
            e.hover(
              function () {
                o.addClass("active"), $(".header__body").addClass("active");
              },
              function () {
                o.removeClass("active"),
                  $(".header__body").removeClass("active");
              }
            ),
            $(".menu__item.not-hover").hover(
              function () {
                o.removeClass("active"),
                  $(".header__body").removeClass("active");
              },
              function () {}
            ),
            $(".menu__list").removeClass("spoiler one"),
            $(".menu__item:not(.not-hover) .menu__link").removeClass(
              "spoiler-header"
            ),
            $(".menu__item:not(.not-hover) .menu__sub").removeClass(
              "spoiler-info"
            ),
            $(".menu__item:not(.not-hover) .menu__link").off("click"))
          : $(window).width() <= 992 &&
            ($(".menu__list").addClass("spoiler one"),
            $(".menu__item:not(.not-hover) .menu__link").addClass(
              "spoiler-header"
            ),
            $(".menu__item:not(.not-hover) .menu__sub").addClass(
              "spoiler-info"
            ),
            $(".menu__item:not(.not-hover) .menu__link").click(function (e) {
              e.preventDefault();
            }));
      }
      i(), $(window).resize(i);
    }),
    $(document).ready(function () {
      $(".select").each(function () {
        const e = $(this),
          t = e.find(".select__btn"),
          o = e.find(".select__list"),
          n = e.find(".select__item");
        t.on("click", function (e) {
          e.stopPropagation(),
            o.toggleClass("select__list-visible"),
            t.toggleClass("select__btn-active");
        }),
          n.on("click", function (i) {
            i.stopPropagation(),
              n.removeClass("active"),
              $(this).addClass("active"),
              t.text($(this).text()),
              e.find(".select__input-hidden").val($(this).data("value")),
              o.removeClass("select__list-visible"),
              t.removeClass("select__btn-active");
          }),
          $(document).on("click", function (e) {
            t.is(e.target) ||
              (o.removeClass("select__list-visible"),
              t.removeClass("select__btn-active"));
          }),
          $(document).on("keydown", function (e) {
            ("Tab" !== e.key && "Escape" !== e.key) ||
              (o.removeClass("select__list-visible"),
              t.removeClass("select__btn-active"));
          });
      });
    }),
    $(document).ready(function () {
      let e = $(".video"),
        t = e.find(".button-play"),
        o = t.find("span"),
        n = e.find(".video__banner"),
        i = t.find("span"),
        s = e.find(".button-icon-play");
      e.each(function (e, r) {
        function l() {
          r.paused ? (r.play(), n.eq(e).addClass("video__hide-bg")) : r.pause();
        }
        (r = r.querySelector("video")) &&
          ((r.onloadedmetadata = function () {
            let t = r.duration,
              n = Math.floor(t / 60),
              i = Math.floor(t % 60),
              s = n + ":" + (i < 10 ? "0" : "") + i;
            o.eq(e).text(s);
          }),
          (r.ontimeupdate = function () {
            let t = r.currentTime,
              o = Math.floor(t / 60),
              n = Math.floor(t % 60),
              s = o + ":" + (n < 10 ? "0" : "") + n;
            i.eq(e).text(s);
          })),
          n.eq(e).click(function () {
            s.eq(e).toggleClass("hide"), l();
          }),
          t.eq(e).click(function () {
            l();
          }),
          s.eq(e).click(function () {
            s.eq(e).toggleClass("hide"), l();
          });
      }),
        $(".popup-form__close").click(function () {
          e.find("video").each(function () {
            this.pause();
          });
        });
    }),
    $(document).ready(function () {
      let e = $(".preim__animate"),
        t = $(".tasks__item.hover");
      function o() {
        e.each(function () {
          let e = $(this);
          $(window).scrollTop() >= e.offset().top - $(window).height() &&
            !e.hasClass("played") &&
            ((function (e) {
              let t = e.find("lottie-player");
              t.get(0).setDirection(1), t.get(0).play();
            })(e),
            e.addClass("played"));
        });
      }
      o(),
        $(window).scroll(function () {
          o();
        }),
        t.each(function () {
          $(this)
            .on("mouseenter", function (e) {
              let t = $(this).find("lottie-player");
              t.get(0).setDirection(1), t.get(0).play();
            })
            .on("mouseleave", function (e) {
              let t = $(this).find("lottie-player");
              t.get(0).setDirection(-1), t.get(0).play();
            });
        });
    }),
    $(document).ready(function () {
      let e = $(".left-menu");
      if (e.length) {
        let t = $(".left-menu__list"),
          o = $(".left-menu__bg"),
          n = $(".left-menu__close"),
          i = $(".left-menu__button"),
          s = $(".left-menu__link"),
          r = $(".scroll-white"),
          l = $(window).scrollTop(),
          a = e.offset().top,
          c = 0,
          d = 0,
          u = 0;
        function f(t) {
          t + 100 >= a ? e.addClass("fixed") : e.removeClass("fixed");
        }
        function p(t) {
          $(".regulations").length &&
            (t + e.height() + 100 >=
              $(".regulations").offset().top + $(".regulations").height() &&
            $(window).width() >= 992
              ? e.hide()
              : e.show());
        }
        $(window).scroll(function () {
          let t = $(window).scrollTop(),
            o = t > u;
          f(t),
            t + e.outerHeight() >= $(".footer").offset().top &&
            $(window).width() >= 992
              ? e.css({ opacity: "0", visibility: "hidden" })
              : e.css({ opacity: "1", visibility: "visible" }),
            s.each(function () {
              let n = $(this);
              if (n.length) {
                let i = n.attr("href").replace("#", ""),
                  r = $("." + i);
                if (r.length) {
                  let i = r.offset().top - 100,
                    l = i + r.height() - 100;
                  if (o) {
                    if (t + e.outerHeight() >= i && t + e.outerHeight() <= l)
                      return (
                        n.hasClass("active") ||
                          (s.removeClass("active"), n.addClass("active")),
                        !1
                      );
                  } else if (
                    t + e.outerHeight() >= i &&
                    t - e.outerHeight() <= l
                  )
                    return (
                      n.hasClass("active") ||
                        (s.removeClass("active"), n.addClass("active")),
                      !1
                    );
                }
              }
            });
          let n = !1,
            i = s.filter(".active");
          r.each(function () {
            let e = $(this).offset().top,
              t = $(this).outerHeight(),
              o = i.offset().top;
            o + i.outerHeight() >= e &&
              o <= e + t &&
              ((n = !0), i.addClass("white"));
          }),
            s.each(function () {
              $(this).hasClass("active") || $(this).removeClass("white");
            }),
            n || s.removeClass("white"),
            p(t),
            (u = t);
        }),
          s.click(function () {
            let e = $(this).attr("href").replace("#", ""),
              n = $("." + e);
            return (
              n.length &&
                (t.hasClass("active") &&
                  (t.removeClass("active"),
                  o.removeClass("active"),
                  $("body").removeClass("lock")),
                $("body,html").animate(
                  { scrollTop: n.offset().top + -100 },
                  500,
                  function () {}
                )),
              !1
            );
          }),
          i.click(function () {
            t.addClass("active"),
              o.addClass("active"),
              $("body").addClass("lock");
          }),
          n.click(function () {
            t.removeClass("active"),
              o.removeClass("active"),
              $("body").removeClass("lock");
          }),
          $(".regulations__tab").click(function () {
            t.removeClass("active"),
              o.removeClass("active"),
              $("body").removeClass("lock");
          }),
          e.on("touchstart", function (e) {
            c = e.originalEvent.touches[0].clientY;
          }),
          e.on("touchmove", function (e) {
            (d = e.originalEvent.touches[0].clientY),
              d - c > 150 &&
                (t.removeClass("active"),
                o.removeClass("active"),
                setTimeout(function () {
                  $("body").removeClass("lock");
                }, 300));
          }),
          f(l),
          p(l);
      }
    }),
    $(document).ready(function () {
      let e = $(".tabs"),
        t = $(".tabs-nav li a");
      $(".tabs.active").show(),
        t.click(function (o) {
          o.preventDefault(),
            e.hide(),
            t.removeClass("active"),
            $(this).addClass("active");
          let n = $(this).attr("href");
          $(n).fadeIn(300);
        }),
        $(".tab").on("click", function (e) {
          let t = $(this).attr("href");
          "#tab-1" === t
            ? $(".regulations__item").show()
            : $(".tab-content " + t)
                .show()
                .siblings()
                .hide(),
            $(this).addClass("active").siblings().removeClass("active"),
            e.preventDefault();
        });
    }),
    $(document).ready(function () {
      $(".spoiler-header").click(function (e) {
        $(".tabs").hasClass("one") &&
          ($(".spoiler-header").not($(this)).removeClass("active"),
          $(".spoiler-info").not($(this).next()).slideUp(300)),
          $(this).toggleClass("active").next().slideToggle(300);
      });
    }),
    $(document).ready(function () {
      const e = $(".popup-open"),
        t = $("body"),
        o = $(".lock-padding");
      let n,
        i,
        s = $(".popup-scroll"),
        r = !1,
        l = !0;
      function a(e, n = !0) {
        l &&
          (e.removeClass("open"),
          n &&
            (setTimeout(function () {
              o.length && o.css("padding-right", "0px"),
                t.css("padding-right", "0px"),
                t.removeClass("lock");
            }, 800),
            (l = !1),
            setTimeout(function () {
              l = !0;
            }, 800)));
      }
      function c() {
        $(window).width() <= 640
          ? (s.on("touchstart", function (e) {
              const t = e.originalEvent.touches[0];
              (n = t.clientY), (i = parseInt($(this).css("top"))), (r = !0);
            }),
            s.on("touchmove", function (e) {
              if (!r) return;
              const t = this.scrollHeight,
                o = e.originalEvent.touches[0].clientY - n,
                s = i + o,
                l = window.innerHeight - document.documentElement.clientHeight,
                a = $(window).height() - t + l,
                c = $(window).height() + 200 - $(this).outerHeight(!0) + l;
              s >= a && s <= c && $(this).css("top", s + "px"),
                o > 100 &&
                  parseInt($(this).css("top")) >= 190 &&
                  parseInt($(this).css("top")) <= 200 &&
                  ($(this).removeClass("open"), $("body").removeClass("lock"));
            }),
            s.on("touchend", function () {
              r = !1;
            }))
          : (s.off("touchstart touchmove touchend"), s.css({ top: "0px" }));
      }
      e.on("click", function (e) {
        const n = $(this).attr("href").replace("#", "");
        !(function (e) {
          if (e.length && l) {
            const n = $(".popup.open");
            n.length
              ? a(n, !1)
              : (function () {
                  const e =
                    window.innerWidth - $(".wrapper").outerWidth() + "px";
                  o.length && o.css("padding-right", e),
                    t.css("padding-right", e),
                    t.addClass("lock"),
                    (l = !1),
                    setTimeout(function () {
                      l = !0;
                    }, 800);
                })(),
              e.addClass("open"),
              e.on("click", function (t) {
                $(t.target).closest(".popup-content").length || a(e);
              });
          }
        })($("#" + n)),
          e.preventDefault();
      }),
        $(".popup-close").on("click", function (e) {
          a($(this).closest(".popup")), e.preventDefault();
        }),
        $(document).on("keydown", function (e) {
          27 === e.which && a($(".popup.open"));
        }),
        Element.prototype.closest ||
          (Element.prototype.closest = function (e) {
            for (var t = this; t; ) {
              if ($(t).is(e)) return t;
              t = t.parentElement;
            }
            return null;
          }),
        Element.prototype.matches ||
          (Element.prototype.matches =
            Element.prototype.matchesSelector ||
            Element.prototype.webkitMatchesSelector ||
            Element.prototype.mozMatchesSelector ||
            Element.prototype.msMatchesSelector),
        c(),
        $(window).resize(c);
    }),
    $(document).ready(function () {
      $(".form__input input")
        .focus(function () {
          $(this).closest(".form__input").addClass("active");
        })
        .blur(function () {
          $(this).closest(".form__input").removeClass("active");
        })
        .keyup(function () {
          "" !== $(this).val().trim()
            ? $(this).closest(".form__input").addClass("text")
            : $(this).closest(".form__input").removeClass("text");
        });
    }),
    $(document).ready(function () {
      $(".file__decor, .file__button").click(function () {
        $(".file__input").click();
      }),
        $(".file__input").change(function () {
          let e = $(this).val().split("\\").pop();
          e
            ? ((e = e.split(".").slice(0, -1).join(".")),
              $(".file__button").text(e))
            : $(".file__button").text("Вы можете прикрепить документ");
        });
    }),
    $(document).ready(function () {
      let e = $(".header__lang"),
        t = $(".header__menu");
      function o() {
        $(window).width() <= 992
          ? (e.appendTo(t), $.contains(t[0], e[0]) && e.css("display", "block"))
          : e.appendTo($(".header__body"));
      }
      function n() {
        $(window).width() <= 640
          ? ($(".footer__social").appendTo($(".footer__column-1")),
            $.contains($(".footer__column-1")[0], $(".footer__social")[0]) &&
              $(".footer__social").css("display", "flex"))
          : $(".footer__social").appendTo(
              $(".footer__column-2 .footer__items:first-child")
            );
      }
      function i() {
        $(window).width() <= 992
          ? $(".news-info__author").appendTo(".append-author")
          : $(".news-info__author").appendTo(".put-author");
      }
      o(),
        n(),
        i(),
        0 === $(".projects").find(".button-absolute").length &&
          $(".projects").css("padding-bottom", "0"),
        $(window).resize(o),
        $(window).resize(n),
        $(window).resize(i);
    }),
    $(document).ready(function () {
      let e = $(".story__slider"),
        t = $(".product__slider"),
        o = $(".news-section__slider"),
        n = $(".news-section__slider-2"),
        i = $(".slider-dots");
      e.on("init", function (e, t, o) {
        let n = t.slideCount;
        t.$dots.find("li").each(function (e) {
          let o = t.$slides.eq(e).find(".story__year").text();
          $(this).append("<span>" + o + "</span>");
        }),
          t.currentSlide < t.slideCount - 1 &&
            t.$dots
              .find("li")
              .eq(t.currentSlide + 1)
              .addClass("next"),
          $(".slider-counter").text(t.currentSlide + 1 + "/" + n);
      }),
        e.on("beforeChange", function (e, t, o, n) {
          t.$dots.find("li").removeClass("next"),
            n < t.slideCount - 1 &&
              t.$dots
                .find("li")
                .eq(n + 1)
                .addClass("next");
        }),
        e.on("afterChange", function (e, t, o) {
          let n = t.currentSlide + 1;
          $(".slider-counter").text(n + "/" + t.slideCount);
        }),
        e.slick({
          variableWidth: !0,
          prevArrow: $(".prev-arrow.story-arrow"),
          nextArrow: $(".next-arrow.story-arrow"),
          dots: !0,
          appendDots: i,
          infinite: !1,
          outerEdgeLimit: !0,
        }),
        t.on("init", function (e, t, o) {
          let n = t.slideCount;
          $(".slider-counter.slider-counter-product").text(
            t.currentSlide + 1 + " из " + n
          );
        }),
        t.on("afterChange", function (e, t, o) {
          let n = t.currentSlide + 1;
          $(".slider-counter.slider-counter-product").text(
            n + " из " + t.slideCount
          );
        }),
        t.slick({
          variableWidth: !0,
          prevArrow: $(".prev-arrow.product-arrow"),
          nextArrow: $(".next-arrow.product-arrow"),
          dots: !1,
          outerEdgeLimit: !0,
        }),
        o.on("init", function (e, t, o) {
          let n = t.slideCount;
          $(".slider-counter.slider-counter-product").text(
            t.currentSlide + 1 + " из " + n
          );
        }),
        o.on("afterChange", function (e, t, o) {
          let n = t.currentSlide + 1;
          $(".slider-counter.slider-counter-product").text(
            n + " из " + t.slideCount
          );
        }),
        o.slick({
          slidesToShow: 1,
          slidesToScroll: 1,
          prevArrow: $(".prev-arrow.news-section-arrow"),
          nextArrow: $(".next-arrow.news-section-arrow"),
          dots: !1,
        }),
        n.on("init", function (e, t, o) {
          let n = t.slideCount;
          $(".slider-counter.slider-counter-product").text(
            t.currentSlide + 1 + " из " + n
          );
        }),
        n.on("afterChange", function (e, t, o) {
          let n = t.currentSlide + 1;
          $(".slider-counter.slider-counter-product").text(
            n + " из " + t.slideCount
          );
        }),
        n.slick({
          slidesToShow: 2,
          slidesToScroll: 1,
          prevArrow: $(".prev-arrow.news-section-arrow-2"),
          nextArrow: $(".next-arrow.news-section-arrow-2"),
          dots: !1,
          responsive: [{ breakpoint: 768, settings: { slidesToShow: 1 } }],
        }),
        $(".people-slider").slick({
          variableWidth: !0,
          dots: !1,
          arrows: !0,
          autoplay: !0,
          speed: 1e3,
          prevArrow: $(".prev-arrow.people-arrow"),
          nextArrow: $(".next-arrow.people-arrow"),
        }),
        $(".news-slider").slick({ variableWidth: !0, arrows: !1 });
    }),
    $(document).ready(function () {
      let e = $(".scroll-trigger"),
        t = $(".headquarters"),
        o = $(".map-headquarters-triangle"),
        n = $(".representatives"),
        i = $(".map-representatives-triangle"),
        s = $(".stalls"),
        r = $(".map-stalls-triangle"),
        l = $(".geography__map .map-item"),
        a = $(".geography__map .map-triangle-grey"),
        c = $(".contacts__map .map-item"),
        d = $(".contacts__map .map-triangle-grey"),
        u = gsap.timeline(),
        f = gsap.timeline();
      ((l.length && a.length) || (c.length && d.length)) &&
        (u.fromTo(
          l,
          { opacity: 0, scale: 0, transformOrigin: "center center" },
          { opacity: 1, scale: 1, duration: 1 }
        ),
        u.fromTo(a, { opacity: 0 }, { opacity: 1, stagger: 0.01 }),
        f.fromTo(
          c,
          { opacity: 0, scale: 0, transformOrigin: "center center" },
          { opacity: 1, scale: 1, duration: 1 }
        ),
        f.fromTo(d, { opacity: 0 }, { opacity: 1, stagger: 0.01 })),
        ScrollTrigger.create({
          animation: u,
          trigger: e,
          start: "top 200",
          end: "bottom",
        }),
        ScrollTrigger.create({
          animation: f,
          trigger: ".con.scroll-trigger",
          start: "top 400",
          end: "bottom",
        });
      let p = new TimelineMax()
          .fromTo(r, { opacity: 0 }, { opacity: 1, stagger: 0.01 })
          .pause(),
        h = new TimelineMax()
          .fromTo(
            i,
            { scale: 0, transformOrigin: "center center" },
            { visibility: "visible", scale: 1, duration: 0.5, stagger: 0.01 }
          )
          .pause(),
        m = new TimelineMax()
          .fromTo(
            o,
            { scale: 0, transformOrigin: "center center" },
            { visibility: "visible", scale: 1, duration: 0.5, stagger: 0.01 }
          )
          .pause();
      s.hover(
        function () {
          p.play();
        },
        function () {
          p.reverse();
        }
      ),
        n.hover(
          function () {
            h.play();
          },
          function () {
            h.reverse();
          }
        ),
        t.hover(
          function () {
            m.play();
          },
          function () {
            m.reverse();
          }
        );
    }),
    $(document).ready(function () {
      let e = $(".download-item"),
        t = $(".download-menu"),
        o = $(".download-menu__item");
      e.click(function () {
        return t.toggleClass("active"), !1;
      }),
        $(document).click(function (e) {
          t.is(e.target) ||
            0 !== t.has(e.target).length ||
            t.removeClass("active");
        }),
        o.hover(
          function () {
            $(this).prev().find("span").css("opacity", "0");
          },
          function () {
            $(this).prev().find("span").css("opacity", "1");
          }
        );
    }),
    $(document).ready(function () {
      let e = $(".header"),
        t = $(window).height();
      $(window).scroll(function () {
        $(this).scrollTop() >= t
          ? e.addClass("scroll")
          : e.removeClass("scroll");
      });
    }),
    $(document).ready(function () {
      $(".search");
      let e = $(".search__input");
      e.find("input").focus(function () {
        e.addClass("focus");
      }),
        e.find("input").blur(function () {
          e.removeClass("focus");
        });
    }),
    $(document).ready(function () {
      $(".goto").click(function () {
        let e = $(this).attr("href").replace("#", "");
        return (
          $("body,html").animate(
            { scrollTop: $("." + e).offset().top + 0 },
            500,
            function () {}
          ),
          !1
        );
      });
    }),
    $(document).ready(function () {
      if ($(".case-info").length) {
        let e = $(".news-section__comment");
        function t() {
          if (e.length) {
            let t = $(".container"),
              o = t.width(),
              n = $(window).width() - (t.offset().left + o);
            e.css("width", "calc(100% + " + n + "px");
          }
        }
        t(), $(window).resize(t);
      }
    });
})();
